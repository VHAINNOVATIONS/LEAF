var form,workflow,formValidator={},LeafForm=function(t){t=t;var a,n,r="LeafForm"+Math.floor(1e3*Math.random())+"_",s=r+"record",i=0;function o(){if(0==i)return console.log("recordID not set"),0;var e=$("#"+a.btnSaveID).html();$("#"+a.btnSaveID).empty().html('<img src="images/indicator.gif" alt="saving" /> Saving...'),$("#"+s).find(":input:disabled").removeAttr("disabled");var o={recordID:i};$("#"+s).serializeArray().map(function(t){o[t.name]=t.value}),$.ajax({type:"POST",url:"ajaxIndex.php?a=domodify",data:o,dataType:"text",success:function(t){null!=n&&n(),$("#"+a.btnSaveID).empty().html(e)},cache:!1})}return $("#"+t).html('<div id="'+r+'xhrDialog" style="display: none; background-color: white; border-style: none solid solid; border-width: 0 1px 1px; border-color: #e0e0e0; padding: 4px">\t\t\t<form id="'+r+'record" enctype="multipart/form-data" action="javascript:void(0);">\t\t\t    <div>\t\t\t        <button id="'+r+'button_cancelchange" class="buttonNorm" style="position: absolute; left: 10px"><img src="../libs/dynicons/?img=process-stop.svg&amp;w=16" alt="cancel" /> Cancel</button>\t\t\t        <button id="'+r+'button_save" class="buttonNorm" style="position: absolute; right: 10px"><img src="../libs/dynicons/?img=media-floppy.svg&amp;w=16" alt="save" /> Save Change</button>\t\t\t        <div style="border-bottom: 2px solid black; line-height: 30px"><br /></div>\t\t\t        <div id="'+r+'loadIndicator" style="visibility: hidden; position: absolute; text-align: center; font-size: 24px; font-weight: bold; background: white; padding: 16px; height: 300px; width: 460px">Loading... <img src="images/largespinner.gif" alt="loading..." /></div>\t\t\t        <div id="'+r+'xhr" style="width: 540px; height: 420px; padding: 8px; overflow: auto"></div>\t\t\t    </div>\t\t\t</form>\t\t\t</div>'),a=new dialogController(r+"xhrDialog",r+"xhr",r+"loadIndicator",r+"button_save",r+"button_cancelchange"),{dialog:function(){return a},getHtmlFormID:function(){return s},serializeData:function(){return $("#"+s).serialize()},setRecordID:function(t){i=t},setPostModifyCallback:function(t){n=t},doModify:o,getForm:function(t,e){if(0==i)return console.log("recordID not set"),0;a.indicateBusy(),a.setSaveHandler(function(){o()}),formValidator=new Object,formRequired=new Object,$.ajax({type:"GET",url:"ajaxIndex.php?a=getindicator&recordID="+i+"&indicatorID="+t+"&series="+e,dataType:"text",success:function(t){for(var e in a.setTitle("Editing #"+i),a.setContent(t),formValidator){var o=e.slice(2);a.setValidator(o,formValidator[e].setValidator),a.setValidatorError(o,formValidator[e].setValidatorError),a.setValidatorOk(o,formValidator[e].setValidatorOk)}for(var e in formRequired)o=e.slice(2),a.setRequired(o,formRequired[e].setRequired),a.setRequiredError(o,formRequired[e].setRequiredError),a.setRequiredOk(o,formRequired[e].setRequiredOk);a.enableLiveValidation()},error:function(t){a.setContent("Error: "+t)},cache:!1})},initCustom:function(t,e,o,n,i){a=new dialogController(t,e,o,n,i),r="",s="record"},setHtmlFormID:function(t){s=t}}},LeafFormGrid=function(d,t){d=d;var p,u,h="LeafFormGrid"+Math.floor(1e3*Math.random())+"_",f=!0,g=[],m=0,l=!1,y=50,v=50,c="#d1dfff",w={},a=null,b=null,_=null,x="",I=!0,D=!1;$("#"+d).html('<div id="'+h+'grid"></div><div id="'+h+'form" style="display: none"></div>'),$("#"+h+"grid").html('<div style="position: relative"><div id="'+h+'gridToolbar" style="display: none; width: 90px; margin: 0 0 0 auto; text-align: right"></div></div><div id="'+h+'table_stickyHeader" style="display: none"></div><table id="'+h+'table" class="leaf_grid"><thead id="'+h+'thead" aria-label="Search Results"></thead><tbody id="'+h+'tbody"></tbody><tfoot id="'+h+'tfoot"></tfoot></table>'),$("#"+h+"thead").css({"background-color":c}),null==t&&(p=new LeafForm(h+"form"));var S=0;function k(o,t){"recordID"!=o&&v!=1/0&&C(0,1/0),$("."+h+"sort").css("display","none"),"asc"==t.toLowerCase()?($("#"+h+"header_"+o+"_sort").html(" &#9650;"),$("#"+h+"header_"+o+"_sort").css("vertical-align","super")):($("#"+h+"header_"+o+"_sort").html(" &#9660;"),$("#"+h+"header_"+o+"_sort").css("vertical-align","sub")),$("#"+h+"header_"+o+"_sort").css("display","inline");var e,n=[],i=$.isNumeric(o),a=!1,r="id"+o;for(var s in g)g[s].recordID=parseInt(g[s].recordID),null==g[s][o]&&(g[s][o]=$("#"+h+g[s].recordID+"_"+o).html(),g[s][o]=null==g[s][o]?"":g[s][o],g[s][o]=g[s][o].replace(/[\u200B-\u200E]/g,"")),i?(null==g[s].s1&&(g[s].s1={}),null!=g[s].s1[r]&&""!=g[s].s1[r]||(null==g[s].sDate&&(g[s].sDate={}),g[s].s1[r]="",g[s].sDate[o]=0),e=null,!isNaN(g[s].s1[r])||-1==g[s].s1[r].indexOf("-")&&-1==g[s].s1[r].indexOf("/")||(e=Date.parse(g[s].s1[r])),(a||null!=e&&!isNaN(e))&&(a=!0,null==g[s].sDate&&(g[s].sDate={}),g[s].sDate[o]=0,g[s].sDate[o]=isNaN(e)?0:e),$.isNumeric(g[s].s1[r])&&(g[s].s1[r]=parseFloat(g[s].s1[r]))):((e=null)==g[s].sDate&&(g[s].sDate={}),g[s].sDate[o]=0,!isNaN(g[s][o])||-1==g[s][o].indexOf("-")&&-1==g[s][o].indexOf("/")||(e=Date.parse(g[s][o])),(a||null!=e&&!isNaN(e))&&(a=!0,g[s].sDate[o]=isNaN(e)||null==e?0:e)),n.push(g[s]);a?n.sort(function(t,e){return e.sDate[o]>t.sDate[o]?1:e.sDate[o]<t.sDate[o]?-1:0}):$.isNumeric(o)?n.sort(function(t,e){return e.s1[r]>t.s1[r]?1:e.s1[r]<t.s1[r]?-1:0}):"recordID"==o?n.sort(function(t,e){return e[o]>t[o]?1:e[o]<t[o]?-1:0}):n.sort(function(t,e){return null==t[o]&&(t[o]=""),null==e[o]&&(e[o]=""),e[o].toLowerCase()>t[o].toLowerCase()?1:e[o].toLowerCase()<t[o].toLowerCase()?-1:0}),"asc"==t&&n.reverse(),g=n}function T(){if(!I)return!1;var e=[];$("#"+h+"thead>tr>th").each(function(){e.push($(this).css("width"))}),$("#"+h+"table_stickyHeader > table").css({width:$("#"+h+"thead").css("width"),height:"30px"}),$("#"+h+"table_stickyHeader > table > thead > tr > th").each(function(t){$(this).css({width:e[t],padding:"2px","font-weight":"normal"})}),$("#"+h+"table_stickyHeader > table").css({border:"1px solid black","border-collapse":"collapse",margin:"0 2px 0"}),$("#"+h+"table_stickyHeader > table > thead > tr").css({"background-color":"black",color:"white"}),$("#"+h+"table_stickyHeader > table > thead > tr > th").css("border","1px solid #e0e0e0")}function C(t,e){D=!0,null!=b&&b(),null==e&&(e=y),v=e;var o=!1;null!=t&&0!=t||(t=0,$("#"+h+"tbody").empty(),o=!0);var n="",i=[],a=f?u.length+1:u.length;0==g.length&&$("#"+h+"tbody").append('<tr><td colspan="'+a+'" style="text-align: center">No Results</td></tr>');for(var r=0,s=t;s<g.length;s++){if(e<=r){m=s;break}for(var d in n+='<tr id="'+h+"tbody_tr"+g[s].recordID+'">',f&&(n+='<td><a href="index.php?a=printview&recordID='+g[s].recordID+'">'+g[s].recordID+"</a></td>"),u)if(0!=u[d].visible)if(null!=g[s]){var l={};l.recordID=g[s].recordID,l.indicatorID=u[d].indicatorID,l.cellContainerID=h+g[s].recordID+"_"+u[d].indicatorID,l.index=s,l.data="";var c=!1;null!=u[d].editable&&0==u[d].editable||(c=!0),$.isNumeric(l.indicatorID)?(null==g[s].s1&&(g[s].s1={}),l.data=null!=g[s].s1["id"+u[d].indicatorID]?g[s].s1["id"+u[d].indicatorID]:"",n+='<td id="'+h+g[s].recordID+"_"+u[d].indicatorID+'" data-editable="'+c+'" data-record-id="'+g[s].recordID+'" data-indicator-id="'+u[d].indicatorID+'">'+l.data+"</td>"):null!=u[d].callback?n+='<td id="'+h+g[s].recordID+"_"+u[d].indicatorID+'" data-clickable="'+c+'"></td>':n+='<td id="'+h+g[s].recordID+"_"+u[d].indicatorID+'"></td>',null!=u[d].callback&&i.push(function(t,e){return function(){t(e,w)}}(u[d].callback,l))}else n+='<td id="'+h+g[s].recordID+"_"+u[d].indicatorID+'"></td>';n+="</tr>",r++,o&&(m=s+1)}for(var s in m+e>=g.length||null==e?$("#"+h+"tfoot").html(""):$("#"+h+"tfoot").html("<tr><td colspan="+a+' style="padding: 8px; background-color: #feffd1; font-size: 120%; font-weight: bold"><img src="'+x+'images/indicator.gif" style="vertical-align: middle" alt="Loading" /> Loading more results...</td></tr>'),$("#"+h+"tbody").append(n),$("#"+h+"tbody td[data-editable=true]").addClass("table_editable"),$("#"+h+"tbody td[data-clickable=true]").addClass("table_editable"),$("#"+h+"tbody").on("click","td[data-editable=true]",function(t){p.setRecordID($(this).data("record-id"));var e=$(this).data("indicator-id");p.setPostModifyCallback(function(){var i,t;i=e,t=1,$.ajax({type:"GET",url:x+"api/?a=form/"+recordID+"/rawIndicator/"+i+"/"+t,dataType:"json",success:function(t){var e=""!=t[i].displayedValue?t[i].displayedValue:t[i].value;if("checkboxes"==t[i].format&&Array.isArray(e)){var o="";for(var n in e)"no"!=e[n]&&(o+=", "+e[n]);e=o.substr(2)}$("#"+h+recordID+"_"+i).empty().html(e),$("#"+h+recordID+"_"+i).fadeOut(250,function(){$("#"+h+recordID+"_"+i).fadeIn(250)})},cache:!1}),p.dialog().hide()}),p.getForm(e,1),p.dialog().show()}),i)i[s]();$("#"+h+"table>tbody>tr>td").css({border:"1px solid black",padding:"8px","font-size":"12px"}),null!=_&&_(),T()}function n(t){l=!0,g=t}function i(t){w=t}return{getPrefixID:function(){return h},form:function(){return p},headers:function(){return u},getCurrentData:function(){return g},hideIndex:function(){f=!1},setHeaders:function(t){u=t;var e='<tr id="'+h+'thead_tr">',o='<tr id="'+h+'tVirt_tr">';for(var n in f&&(e+='<th id="'+h+'header_UID" style="text-align: center">UID</th>',o+='<th style="text-align: center">UID</th>'),$("#"+h+"thead").html(e),f&&($("#"+h+"header_UID").css("cursor","pointer"),$("#"+h+"header_UID").on("click",null,null,function(t){S=0==S?(k("recordID","asc"),1):(k("recordID","desc"),0),C(0,1/0)}),$("#"+h+"header_UID").on("mouseover",null,null,function(t){$("#"+h+"header_UID").css("background-color","#79a2ff")}),$("#"+h+"header_UID").on("mouseout",null,null,function(t){$("#"+h+"header_UID").css({"background-color":c})})),u)if(0!=u[n].visible){var i=null!=u[n].align?u[n].align:"center";$("#"+h+"thead_tr").append('<th id="'+h+"header_"+u[n].indicatorID+'" tabindex="0"  style="text-align:'+i+'">'+u[n].name+'<span id="'+h+"header_"+u[n].indicatorID+'_sort" class="'+h+'sort"></span></th>'),o+='<th id="Vheader_'+u[n].indicatorID+'" style="text-align:'+i+'">'+u[n].name+"</th>",null!=u[n].sortable&&1!=u[n].sortable||($("#"+h+"header_"+u[n].indicatorID).css("cursor","pointer"),$("#"+h+"header_"+u[n].indicatorID).on("click",null,u[n].indicatorID,function(t){S=0==S?(k(t.data,"asc"),1):(k(t.data,"desc"),0),C(0,1/0)}),$("#"+h+"header_"+u[n].indicatorID).on("keydown",null,u[n].indicatorID,function(t){13==t.keyCode&&(S=0==S?(k(t.data,"asc"),1):(k(t.data,"desc"),0),C(0,1/0))}),$("#"+h+"header_"+u[n].indicatorID).on("mouseover",null,u[n].indicatorID,function(t){$("#"+h+"header_"+t.data).css("background-color","#79a2ff")}),$("#"+h+"header_"+u[n].indicatorID).on("mouseout",null,u[n].indicatorID,function(t){$("#"+h+"header_"+t.data).css({"background-color":c})}))}$("#"+h+"thead").append("</tr>"),o+="</tr>",$("#"+h+"table>thead>tr>th").css({border:"1px solid black",padding:"4px 2px 4px 2px","font-size":"12px"});var a,r=!1;$("#"+h+"table_stickyHeader").html("<table><thead>"+o+"</thead></table>"),$(window).on("resize",function(){T()}),$(window).on("scroll",function(){r=!0});var s=[];setInterval(function(){scrollPos=$(window).scrollTop(),tableHeight=$("#"+h+"table").height(),pageHeight=$(window).height(),r&&null!=$("#"+h+"thead").offset()&&I&&(r=!1,a=$("#"+h+"thead").offset().top,scrollPos>a&&scrollPos<tableHeight+a?($("#"+h+"table_stickyHeader").css("display","inline"),$("#"+h+"table_stickyHeader").css({position:"absolute",top:scrollPos+"px"})):$("#"+h+"table_stickyHeader").css("display","none")),scrollPos>tableHeight-.8*pageHeight&&l&&D&&null==s[m]&&(s[m]=1,C(m,y))},100)},sort:k,renderVirtualHeader:T,renderBody:C,loadData:function(t,i){g=[];var e=f?u.length+1:u.length;$("#"+h+"tbody").html('<tr><td colspan="'+e+'" style="text-align: left; padding: 8px">Building report... <img src="'+x+'images/largespinner.gif" alt="loading..." /></td></tr>');var o="";for(var n in u)$.isNumeric(u[n].indicatorID)&&(o+=u[n].indicatorID+",");$.ajax({type:"POST",url:x+"api/?a=form/customData",dataType:"json",data:{recordList:t,indicatorList:o,CSRFToken:CSRFToken},success:function(t){for(var e in l=!0,t){if(null!=w[e])for(var o in w[e])if("object"==typeof w[e][o])for(var n in w[e][o])t[e][o]=t[e][o]||{},t[e][o][n]=w[e][o][n];else t[e][o]=w[e][o];g.push(t[e])}null!=a&&(g=a(g)),k("recordID","desc"),C(0,y),null!=i&&"function"==typeof i&&i()},cache:!1})},setData:n,setDataBlob:i,importQueryResult:function(t){var e=[];for(var o in t)e.push(t[o]);n(e),i(e)},enableToolbar:function(){d=h+"gridToolbar",$("#"+d).css("display","block"),$("#"+d).html('<button type="button" id="'+h+'getExcel" class="buttonNorm"><img src="../libs/dynicons/?img=x-office-spreadsheet.svg&w=32" alt="Icon of Spreadsheet" /> Export</button>'),$("#"+h+"getExcel").on("click",function(){m!=g.length&&C(0,1/0);var o=[],n=[];$("#"+h+"thead>tr>th").each(function(t,e){n.push($(e).text().trim())});var i={},a=0,r=(document.createElement("a"),n.length-1);$("#"+h+"tbody>tr>td").each(function(t,e){i[n[a]]=$(e).text().trim(),0==a&&"UID"==n[a]&&(i[n[a]]='=HYPERLINK("'+window.location.origin+window.location.pathname+"?a=printview&recordID="+$(e).text().trim()+'", "'+$(e).text().trim()+'")'),r<++a&&(o.push(i),i={},a=0)});var t=$(document.createElement("form"));t.attr({action:x+"api/?a=converter/json&format=csv",method:"POST"});var e=$(document.createElement("input")),s=$(document.createElement("input"));e.attr({type:"hidden",name:"input",value:JSON.stringify(o)}),s.attr({type:"hidden",name:"CSRFToken",value:CSRFToken}),t.append(e),t.append(s),t.appendTo("#"+d),t.submit(),t.remove()})},setPostProcessDataFunc:function(t){a=t},setPreRenderFunc:function(t){b=t},setPostRenderFunc:function(t){_=t},setDefaultLimit:function(t){y=t},getDefaultLimit:function(){return y},getDataByIndex:function(t){return g[t]},getDataByRecordID:function(t){for(var e in g)if(g[e].recordID==t)return g[e];return null},disableVirtualHeader:function(){I=!1},stop:function(){D=!1},setRootURL:function(t){x=t}}},LeafFormQuery=function(){var a={},e=null,o="",n=!1;function t(){a={terms:[],joins:[],sort:{},getData:[]}}function i(t,e,o){var n={};n.id=t,n.operator=e,n.match=o,a.terms.push(n)}function r(t,e,o,n){var i={};i.id=t,i.indicatorID=e,i.operator=o,i.match=n,a.terms.push(i)}function s(t){a.limitOffset=t}function d(t){-1==a.joins.indexOf(t)&&a.joins.push(t)}function l(t){-1==a.getData.indexOf(t)&&a.getData.push(t)}return t(),{clearTerms:t,addTerm:i,addDataTerm:r,importQuery:function(t){for(var e in t.terms)switch(Object.keys(t.terms[e]).length){case 3:i(t.terms[e].id,t.terms[e].operator,t.terms[e].match);break;case 4:r(t.terms[e].id,t.terms[e].indicatorID,t.terms[e].operator,t.terms[e].match);break;default:console.log("Format error")}for(var e in t.joins)d(t.joins[e]);for(var e in t.getData)l(t.getData[e])},getQuery:function(){return a},getData:l,updateTerm:function(t,e,o){for(var n in a.terms)if(a.terms[n].id==t&&a.terms[n].operator==e)return void(a.terms[n].match=o);i(t,e,o)},updateDataTerm:function(t,e,o,n){for(var i in a.terms)if(a.terms[i].id==t&&a.terms[i].indicatorID==e&&a.terms[i].operator==o)return void(a.terms[i].match=n);r(t,e,o,n)},setQuery:function(t){a=t},setLimit:function(t,e){void 0===e?a.limit=t:(a.limit=e,s(t))},setLimitOffset:s,setRootURL:function(t){o=t},getRootURL:function(){return o},useJSONP:function(t){n=t},join:d,sort:function(t,e){a.sort.column=t,a.sort.direction=e},onSuccess:function(t){e=t},execute:function(){return null!=a.getData&&0==a.getData.length&&delete a.getData,0==n?$.ajax({type:"GET",url:o+"api/?a=form/query&q="+JSON.stringify(a),dataType:"json",success:e,cache:!1}):$.ajax({type:"GET",url:o+"api/?a=form/query&q="+JSON.stringify(a)+"&format=jsonp",dataType:"jsonp",success:e,cache:!1})}}},LeafFormSearch=function(t){t=t;var s="LeafFormSearch"+Math.floor(1e3*Math.random())+"_",o="LeafFormSearch"+function(){var t,e,o,n=0;if(0==document.URL.length)return n;for(t=0,o=document.URL.length;t<o;t++)e=document.URL.charCodeAt(t),n=(n<<5)-n+e,n|=0;return n}(),n="",i=0,a="",r=null,d=null,e=null,l=new LeafFormQuery,c=0,p="",u="0",h="0.0";function f(){$("#"+t).html('<div>\t\t\t    <img id="'+s+'searchIcon" class="searchIcon" alt="search" style="vertical-align: middle; padding-right: 4px; display: inline;" src="'+p+'../libs/dynicons/?img=search.svg&w=16">\t\t\t    <img id="'+s+'searchIconBusy" class="searchIcon" alt="loading" style="vertical-align: middle; padding-right: 4px; display:none" src="'+p+'images/indicator.gif">\t\t\t    <input style="border: 1px solid black; padding: 4px" type="text" id="'+s+'searchtxt" name="searchtxt" size="50" title="Enter your search text" value="" />\t\t\t    <button class="buttonNorm" id="'+s+'advancedSearchButton">Advanced Options</button>\t\t\t    <fieldset id="'+s+'advancedOptions" style="position: relative; display: none; margin: 0px; border: 1px solid black; background-color: white">\t\t        <legend>Advanced Search Options</legend>\t\t        <img id="'+s+'advancedOptionsClose" src="'+p+'../libs/dynicons/?img=process-stop.svg&w=16" tabindex="0" style="float: right; margin-top: -20px; margin-right: -14px; display: none; cursor: pointer" alt="Close advanced search"/>\t\t        <div style="width: 550px">Find items where...</div>\t\t        <table id="'+s+'searchTerms"></table>\t\t        <button class="buttonNorm" id="'+s+'addTerm" style="float: left">And...</button>\t\t        <br /><br />\t\t        <button id="'+s+'advancedSearchApply" class="buttonNorm" style="text-align: center; width: 100%">Apply Filters</button>\t\t    </fieldset>\t\t    </div>\t\t    <div id="'+s+'_result" style="margin-top: 8px" aria-label="Search Results">\t\t    </div>');var e=0;$("#"+s+"advancedOptionsClose").on("click",function(){localStorage.setItem(o+".search",""),$("#"+s+"searchtxt").val(""),y(""),$("#"+s+"advancedOptionsClose").css("display","none"),$("#"+s+"advancedOptions").slideUp(function(){$("#"+s+"advancedSearchButton").fadeIn(),$("#"+s+"searchtxt").css("display","inline"),$("#"+s+"searchtxt").animate({width:e},400,"swing"),$("#"+s+"searchtxt").focus()})});e=0;$("#"+s+"advancedOptionsClose").on("keydown",function(t){13==t.keyCode&&(localStorage.setItem(o+".search",""),$("#"+s+"searchtxt").val(""),y(""),$("#"+s+"advancedOptionsClose").css("display","none"),$("#"+s+"advancedOptions").slideUp(function(){$("#"+s+"advancedSearchButton").fadeIn(),$("#"+s+"searchtxt").css("display","inline"),$("#"+s+"searchtxt").animate({width:e},400,"swing"),$("#"+s+"searchtxt").focus()}))}),$("#"+s+"advancedSearchButton").on("click",function(){e=$("#"+s+"searchtxt").width(),$("#"+s+"advancedSearchButton").fadeOut(),$("#"+s+"searchtxt").animate({width:"0px"},400,"swing",function(){$("#"+s+"searchtxt").css("display","none"),$("#"+s+"advancedOptions").slideDown(function(){$("#"+s+"advancedOptionsClose").fadeIn()}),$("#"+s+"advancedOptions").css("display","inline"),$(".chosen").chosen({disable_search_threshold:6}),g(),$("#"+s+"widgetMat_0").focus()})}),$("#"+s+"advancedSearchApply").on("click",function(){w(),k()}),$("#"+s+"addTerm").on("click",function(){S(),$(".chosen").chosen({disable_search_threshold:6})}),$("#"+s+"searchtxt").on("keydown",function(t){w(),i=0,13==t.keyCode&&y($("#"+s+"searchtxt").val())}),S()}function g(t){var e=!0,o={};try{o=null!=t?t:JSON.parse(m())}catch(t){e=!1}if(e&&null!=o&&c<=o.length){for(var n=1;n<o.length;n++)S();for(n=0;n<o.length;n++)$("#"+s+"widgetTerm_"+n).val(o[n].id),$("#"+s+"widgetTerm_"+n).trigger("chosen:updated"),null!=o[n].indicatorID||"serviceID"==o[n].id||"categoryID"==o[n].id||"stepID"==o[n].id?D(n,function(t,e,o,n){return function(){$("#"+s+"widgetIndicator_"+t).val(e),$("#"+s+"widgetIndicator_"+t).trigger("chosen:updated"),$("#"+s+"widgetCod_"+t).val(o),$("#"+s+"widgetCod_"+t).trigger("chosen:updated"),$("#"+s+"widgetMat_"+t).val(n.replace(/\*/g,"")),$("#"+s+"widgetMat_"+t).trigger("chosen:updated")}}(n,o[n].indicatorID,o[n].operator,o[n].match)):D(n),$("#"+s+"widgetCod_"+n).val(o[n].operator),"string"==typeof o[n].match&&$("#"+s+"widgetMat_"+n).val(o[n].match.replace(/\*/g,""))}}function m(){return localStorage.getItem(o+".search")}function y(t){return"*"!=t&&localStorage.setItem(o+".search",t),e(t)}function v(){$("#"+s+"searchtxt").focus()}function w(){$("#"+s+"searchIcon").css("display","none"),$("#"+s+"searchIconBusy").css("display","inline")}function b(){$("#"+s+"searchIcon").css("display","inline"),$("#"+s+"searchIconBusy").css("display","none")}function _(t,e){null==e&&(e="userName"),"undefined"==typeof employeeSelector?($("head").append('<link type="text/css" rel="stylesheet" href="'+n+'/css/employeeSelector.css" />'),$.ajax({type:"GET",url:n+"/js/employeeSelector.js",dataType:"script",success:function(){empSel=new employeeSelector(s+"widgetEmp_"+t),empSel.apiPath=n+"/api/",empSel.rootPath=n+"/",empSel.outputStyle="micro",empSel.setSelectHandler(function(){null!=empSel.selectionData[empSel.selection]&&(selection="empUID"==e?empSel.selection:empSel.selectionData[empSel.selection].userName,$("#"+s+"widgetMat_"+t).val(selection))}),empSel.setResultHandler(function(){null!=empSel.selectionData[empSel.selection]&&(selection="empUID"==e?empSel.selection:empSel.selectionData[empSel.selection].userName,$("#"+s+"widgetMat_"+t).val(selection))}),empSel.initialize()}})):(empSel=new employeeSelector(s+"widgetEmp_"+t),empSel.apiPath=n+"/api/",empSel.rootPath=n+"/",empSel.outputStyle="micro",empSel.setSelectHandler(function(){null!=empSel.selectionData[empSel.selection]&&(selection="empUID"==e?empSel.selection:empSel.selectionData[empSel.selection].userName,$("#"+s+"widgetMat_"+t).val(selection))}),empSel.setResultHandler(function(){null!=empSel.selectionData[empSel.selection]&&(selection="empUID"==e?empSel.selection:empSel.selectionData[empSel.selection].userName,$("#"+s+"widgetMat_"+t).val(selection))}),empSel.initialize())}function x(t){"undefined"==typeof positionSelector?($("head").append('<link type="text/css" rel="stylesheet" href="'+n+'/css/positionSelector.css" />'),$.ajax({type:"GET",url:n+"/js/positionSelector.js",dataType:"script",success:function(){posSel=new positionSelector(s+"widgetPos_"+t),posSel.apiPath=n+"/api/",posSel.rootPath=n+"/",posSel.setSelectHandler(function(){$("#"+s+"widgetMat_"+t).val(posSel.selection)}),posSel.setResultHandler(function(){$("#"+s+"widgetMat_"+t).val(posSel.selection)}),posSel.initialize()}})):(posSel=new positionSelector(s+"widgetPos_"+t),posSel.apiPath=n+"/api/",posSel.rootPath=n+"/",posSel.setSelectHandler(function(){$("#"+s+"widgetMat_"+t).val(posSel.selection)}),posSel.setResultHandler(function(){$("#"+s+"widgetMat_"+t).val(posSel.selection)}),posSel.initialize())}function I(t){"undefined"==typeof groupSelector?($("head").append('<link type="text/css" rel="stylesheet" href="'+n+'/css/groupSelector.css" />'),$.ajax({type:"GET",url:n+"/js/groupSelector.js",dataType:"script",success:function(){grpSel=new groupSelector(s+"widgetGrp_"+t),grpSel.apiPath=n+"/api/",grpSel.rootPath=n+"/",grpSel.setSelectHandler(function(){$("#"+s+"widgetMat_"+t).val(grpSel.selection)}),grpSel.setResultHandler(function(){$("#"+s+"widgetMat_"+t).val(grpSel.selection)}),grpSel.initialize()}})):(grpSel=new groupSelector(s+"widgetGrp_"+t),grpSel.apiPath=n+"/api/",grpSel.rootPath=n+"/",grpSel.setSelectHandler(function(){$("#"+s+"widgetMat_"+t).val(grpSel.selection)}),grpSel.setResultHandler(function(){$("#"+s+"widgetMat_"+t).val(grpSel.selection)}),grpSel.initialize())}function D(r,i){switch($("#"+s+"widgetTerm_"+r).val()){case"title":$("#"+s+"widgetCondition_"+r).html('<select id="'+s+"widgetCod_"+r+'" class="chosen"  aria-label="title" style="width: 120px">\t\t\t\t\t\t<option value="LIKE">CONTAINS</option>\t\t\t\t\t\t<option value="NOT LIKE">DOES NOT CONTAIN</option>\t            \t\t<option value="=">=</option>\t\t\t\t\t\t<option value="!=">!=</option>\t            \t</select>'),$("#"+s+"widgetMatch_"+r).html('<input type="text" aria-label="text" id="'+s+"widgetMat_"+r+'" style="width: 250px" />');break;case"serviceID":$("#"+s+"widgetCondition_"+r).html('<select id="'+s+"widgetCod_"+r+'" class="chosen"  aria-label="title" style="width: 120px">                        <option value="=">IS</option>                        <option value="!=">IS NOT</option>                    </select>'),$.ajax({type:"GET",url:"./api/?a=system/services",dataType:"json",success:function(t){var e='<select id="'+s+"widgetMat_"+r+'" class="chosen" aria-label="services" style="width: 250px">';for(var o in t)e+='<option value="'+t[o].groupID+'">'+t[o].groupTitle+"</option>";e+="</select>",$("#"+s+"widgetMatch_"+r).html(e),$(".chosen").chosen({disable_search_threshold:6}),null!=i&&i()}});break;case"date":case"dateInitiated":case"dateSubmitted":$("#"+s+"widgetCondition_"+r).html('<select id="'+s+"widgetCod_"+r+'" style="width: 140px" class="chosen" aria-label="date">\t            \t\t<option value="=">ON</option>\t            \t\t<option value=">=">ON AND AFTER</option>\t            \t\t<option value="<=">ON AND BEFORE</option>\t            \t</select>'),$("#"+s+"widgetMatch_"+r).html('<input type="text" aria-label="text" id="'+s+"widgetMat_"+r+'" style="width: 200px" />'),jQuery.ui?$("#"+s+"widgetMat_"+r).datepicker():$.getScript("../libs/js/jquery/jquery-ui.custom.min.js",function(){$("#"+s+"widgetMat_"+r).datepicker()});break;case"categoryID":$("#"+s+"widgetCondition_"+r).html('<select id="'+s+"widgetCod_"+r+'" style="width: 140px" class="chosen" aria-label="categoryID">\t            \t\t<option value="=">IS</option>\t            \t\t<option value="!=">IS NOT</option>\t            \t</select>'),$.ajax({type:"GET",url:"./api/?a=workflow/categoriesUnabridged",dataType:"json",success:function(t){var e='<select id="'+s+"widgetMat_"+r+'" class="chosen" aria-label="categories" style="width: 250px">';for(var o in t)e+='<option value="'+t[o].categoryID+'">'+t[o].categoryName+"</option>";e+="</select>",$("#"+s+"widgetMatch_"+r).html(e),$(".chosen").chosen({disable_search_threshold:6}),null!=i&&i()},cache:!1});break;case"userID":$("#"+s+"widgetCondition_"+r).html('<input type="hidden" id="'+s+"widgetCod_"+r+'" value="=" /> IS'),$("#"+s+"widgetMatch_"+r).html('<div id="'+s+"widgetEmp_"+r+'" style="width: 280px"></div><input type="hidden" id="'+s+"widgetMat_"+r+'" />'),_(r);break;case"dependencyID":$("#"+s+"widgetCondition_"+r).html('<input type="hidden" id="'+s+"widgetCod_"+r+'" value="=" /> ='),$.ajax({type:"GET",url:"./api/?a=workflow/dependencies",dataType:"json",success:function(t){var e='<select id="'+s+"widgetIndicator_"+r+'" class="chosen" aria-label="dependencies" style="width: 250px">';for(var o in t)e+='<option value="'+t[o].dependencyID+'">'+t[o].description+"</option>";e+="</select>",$("#"+s+"widgetTerm_"+r).after(e);var n='<select id="'+s+"widgetMat_"+r+'" class="chosen" aria-label="options" style="width: 250px">';n+='<option value="1">Reviewed</option>',n+='<option value="0">Not Reviewed</option>',n+='<option value="-1">Returned to a previous step</option>',n+="</select>",$("#"+s+"widgetMatch_"+r).html(n),$(".chosen").chosen({disable_search_threshold:6}),$("#"+s+"widgetTerm_"+r+"_chosen").css("display","none"),null!=i&&i()},cache:!1});break;case"stepID":$("#"+s+"widgetCondition_"+r).html('<select id="'+s+"widgetCod_"+r+'" style="width: 140px" class="chosen" aria-label="categoryID">\t            \t\t<option value="=">IS</option>\t            \t\t<option value="!=">IS NOT</option>\t            \t</select>'),$.ajax({type:"GET",url:"./api/?a=workflow/steps",dataType:"json",success:function(t){var e='<select id="'+s+"widgetMat_"+r+'" class="chosen" aria-label="stepID" style="width: 250px">';for(var o in e+='<option value="submitted">Submitted</option>',e+='<option value="deleted">Cancelled</option>',e+='<option value="resolved">Resolved</option>',t)e+='<option value="'+t[o].stepID+'">'+t[o].description+": "+t[o].stepTitle+"</option>";e+="</select>",$("#"+s+"widgetMatch_"+r).html(e),$(".chosen").chosen({disable_search_threshold:6}),null!=i&&i()},cache:!1});break;case"data":$.ajax({type:"GET",url:"./api/?a=form/indicator/list",dataType:"json",success:function(a){var t='<select id="'+s+"widgetIndicator_"+r+'" class="chosen" aria-label="data" style="width: 250px">';for(var e in t+='<option value="'+u+'">Any standard data field</option>',t+='<option value="'+h+'">Any Org. Chart employee field</option>',a)t+='<option value="'+a[e].indicatorID+'">'+a[e].categoryName+": "+a[e].name+"</option>";t+="</select><br />",$("#"+s+"widgetTerm_"+r).after(t),$(".chosen").chosen({disable_search_threshold:6}),$("#"+s+"widgetIndicator_"+r).css("float","right"),$("#"+s+"widgetIndicator_"+r).on("change chosen:updated",function(){for(var t in iID=$("#"+s+"widgetIndicator_"+r).val(),iID==u?($("#"+s+"widgetCondition_"+r).html('<select id="'+s+"widgetCod_"+r+'" class="chosen" aria-label="condition" style="width: 120px">\t\t\t\t\t\t\t\t\t\t<option value="LIKE">CONTAINS</option>\t\t\t\t\t\t\t\t\t\t<option value="NOT LIKE">DOES NOT CONTAIN</option>\t\t\t\t\t            \t\t<option value="=">=</option>\t\t\t\t\t\t\t\t\t\t<option value="!=">!=</option>\t\t\t\t\t            \t</select>'),$("#"+s+"widgetMatch_"+r).html('<input type="text" aria-label="text" id="'+s+"widgetMat_"+r+'" style="width: 200px" />'),$(".chosen").chosen({disable_search_threshold:6})):iID==h&&($("#"+s+"widgetCondition_"+r).html('<input type="hidden" id="'+s+"widgetCod_"+r+'" value="=" /> IS'),$("#"+s+"widgetMatch_"+r).html('<div id="'+s+"widgetEmp_"+r+'" style="width: 280px"></div><input type="hidden" id="'+s+"widgetMat_"+r+'" />'),_(r,"empUID")),a)if(a[t].indicatorID==iID){var e=a[t].format.indexOf("\n");switch(-1==e?a[t].format:a[t].format.substr(0,e).trim()){case"number":case"currency":$("#"+s+"widgetCondition_"+r).html('<select id="'+s+"widgetCod_"+r+'" class="chosen" aria-label="currency" style="width: 55px">\t\t\t\t\t\t\t\t            \t\t<option value="=">=</option>\t\t\t\t\t\t\t\t            \t\t<option value=">">></option>\t\t\t\t\t\t\t\t            \t\t<option value=">=">>=</option>\t\t\t\t\t\t\t\t            \t\t<option value="<"><</option>\t\t\t\t\t\t\t\t            \t\t<option value="<="><=</option>\t\t\t\t\t\t\t\t            \t</select>'),$(".chosen").chosen({disable_search_threshold:6});break;case"date":$("#"+s+"widgetCondition_"+r).html('<select id="'+s+"widgetCod_"+r+'" style="width: 140px" class="chosen" aria-label="date">                            \t            \t\t<option value="=">ON</option>                            \t            \t\t<option value=">=">ON AND AFTER</option>                            \t            \t\t<option value="<=">ON AND BEFORE</option>                            \t            \t</select>'),$("#"+s+"widgetMatch_"+r).html('<input type="text" aria-label="text" id="'+s+"widgetMat_"+r+'" style="width: 200px" />'),jQuery.ui?$("#"+s+"widgetMat_"+r).datepicker():$.getScript("../libs/js/jquery/jquery-ui.custom.min.js",function(){$("#"+s+"widgetMat_"+r).datepicker()}),$(".chosen").chosen({disable_search_threshold:6});break;case"orgchart_employee":$("#"+s+"widgetCondition_"+r).html('<select id="'+s+"widgetCod_"+r+'" class="chosen" aria-label="condition" style="width: 120px">\t\t\t\t\t\t\t\t            \t\t<option value="=">IS</option>\t\t\t\t\t\t\t\t\t\t\t\t\t<option value="!=">IS NOT</option>\t\t\t\t\t\t\t\t            \t</select>'),$("#"+s+"widgetMatch_"+r).html('<div id="'+s+"widgetEmp_"+r+'" style="width: 280px"></div><input type="hidden" id="'+s+"widgetMat_"+r+'" />'),$(".chosen").chosen({disable_search_threshold:6}),_(r,"empUID");break;case"orgchart_position":$("#"+s+"widgetCondition_"+r).html('<select id="'+s+"widgetCod_"+r+'" class="chosen" aria-label="condition" style="width: 120px">\t\t\t\t\t\t\t\t            \t\t<option value="=">IS</option>\t\t\t\t\t\t\t\t\t\t\t\t\t<option value="!=">IS NOT</option>\t\t\t\t\t\t\t\t            \t</select>'),$("#"+s+"widgetMatch_"+r).html('<div id="'+s+"widgetPos_"+r+'" style="width: 280px"></div><input type="hidden" id="'+s+"widgetMat_"+r+'" />'),$(".chosen").chosen({disable_search_threshold:6}),x(r);break;case"orgchart_group":$("#"+s+"widgetCondition_"+r).html('<select id="'+s+"widgetCod_"+r+'" class="chosen" aria-label="condition" style="width: 120px">\t\t\t\t\t\t\t\t            \t\t<option value="=">IS</option>\t\t\t\t\t\t\t\t\t\t\t\t\t<option value="!=">IS NOT</option>\t\t\t\t\t\t\t\t            \t</select>'),$("#"+s+"widgetMatch_"+r).html('<div id="'+s+"widgetGrp_"+r+'" style="width: 280px"></div><input type="hidden" id="'+s+"widgetMat_"+r+'" />'),$(".chosen").chosen({disable_search_threshold:6}),I(r);break;case"dropdown":case"radio":$("#"+s+"widgetCondition_"+r).html('<input type="hidden" id="'+s+"widgetCod_"+r+'" value="=" /> IS');var o=a[t].format.split("\n");o.shift();var n='<select id="'+s+"widgetMat_"+r+'" class="chosen" aria-label="options" style="width: 250px">';for(var t in o){var i=-1==o[t].indexOf("default:")?o[t].trim():o[t].substr(8).trim();n+='<option value="'+i+'">'+i+"</option>"}n+="</select>",$("#"+s+"widgetMatch_"+r).html(n),$(".chosen").chosen({disable_search_threshold:6});break;default:$("#"+s+"widgetCondition_"+r).html('<select id="'+s+"widgetCod_"+r+'" class="chosen" aria-label="condition" style="width: 120px">\t\t\t\t\t\t\t\t\t\t\t\t\t<option value="LIKE">CONTAINS</option>\t\t\t\t\t\t\t\t\t\t\t\t\t<option value="NOT LIKE">DOES NOT CONTAIN</option>\t\t\t\t\t\t\t\t            \t\t<option value="=">=</option>\t\t\t\t\t\t\t\t\t\t\t\t\t<option value="!=">!=</option>\t\t\t\t\t\t\t\t            \t</select>'),$("#"+s+"widgetMatch_"+r).html('<input type="text" aria-label="text" id="'+s+"widgetMat_"+r+'" style="width: 200px" />'),$(".chosen").chosen({disable_search_threshold:6})}}}),$("#"+s+"widgetTerm_"+r+"_chosen").css("display","none"),null!=i&&i()},cache:!1});break;default:$("#"+s+"widgetCondition_"+r).html('<select id="'+s+"widgetCod_"+r+'" class="chosen" aria-label="condition" style="width: 55px">\t\t            \t\t<option value="=">=</option>\t\t            \t\t<option value=">">></option>\t\t            \t\t<option value=">=">>=</option>\t\t            \t\t<option value="<"><</option>\t\t            \t\t<option value="<="><=</option>\t\t            \t\t<option value="LIKE">CONTAINS</option>\t\t            \t</select>'),$("#"+s+"widgetMatch_"+r).html('<input type="text" aria-label="text" id="'+s+"widgetMat_"+r+'" style="width: 200px" />')}}function S(){$('<tr id="'+s+"widget_"+c+'">\t\t\t\t\t\t<td id="'+s+"widgetRemove_"+c+'"><button id="widgetRemoveButton"><img src="'+p+'../libs/dynicons/?img=list-remove.svg&w=16" style="cursor: pointer" alt="remove search term" /></button></td>\t\t\t\t\t\t<td><select id="'+s+"widgetTerm_"+c+'" style="width: 150px" class="chosen" aria-label="condition">            \t\t\t\t<option value="title">Title</option>            \t\t\t\t<option value="serviceID">Service</option>            \t\t\t\t<option value="dateSubmitted">Date Submitted</option>            \t\t\t\t<option value="categoryID">Type</option>            \t\t\t\t<option value="userID">Initiator</option>            \t\t\t\t<option value="dependencyID">Requirement</option>            \t\t\t\t<option value="stepID">Current Status</option>            \t\t\t\t<option value="data">Data Field</option>            \t\t\t\t</select></td>\t\t\t            <td id="'+s+"widgetCondition_"+c+'"></td>\t\t\t\t\t\t<td id="'+s+"widgetMatch_"+c+'"></td>\t\t\t\t\t  </tr>').appendTo("#"+s+"searchTerms"),D(c),$("#"+s+"widgetTerm_"+c).on("change","",c,function(t){D(t.data),$(".chosen").chosen({disable_search_threshold:6})}),$("#"+s+"widgetRemove_"+c).on("click","",c,function(t){$("#"+s+"widget_"+t.data).remove()}),c++}function k(){l.clearTerms();for(var t=0;t<c;t++)null!=$("#"+s+"widgetTerm_"+t).val()&&(term=$("#"+s+"widgetTerm_"+t).val(),"data"!=term&&"dependencyID"!=term?(id=$("#"+s+"widgetTerm_"+t).val(),cod=$("#"+s+"widgetCod_"+t).val(),match=$("#"+s+"widgetMat_"+t).val(),"LIKE"==cod&&(match="*"+match+"*"),l.addTerm(id,cod,match)):(id=$("#"+s+"widgetTerm_"+t).val(),indicatorID=$("#"+s+"widgetIndicator_"+t).val(),cod=$("#"+s+"widgetCod_"+t).val(),match=$("#"+s+"widgetMat_"+t).val(),"LIKE"==cod&&(match="*"+match+"*"),l.addDataTerm(id,indicatorID,cod,match)));0<l.getQuery().terms.length?$("#"+s+"searchtxt").val(JSON.stringify(l.getQuery().terms)):$("#"+s+"searchtxt").val("*")}return{init:function(){if(f(),r=setInterval(function(){!function(){if(null==$("#"+s+"searchtxt"))return clearInterval(r);if(400<(i+=5e3<i?0:200)){var t=$("#"+s+"searchtxt").val();""!=t&&t!=a?(a=t,null!=d&&d.abort(),d=y(t)):(""==t&&(t!=a&&y(""),a=t,$("#"+this.prefixID+"_result").html(""),0),b())}}()},200),/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||v(),null==m())y("*");else{var t=m(),e=!0;try{JSON.parse(t)}catch(t){e=!1}"["!=t.substr(0,1)&&(e=!1),e?($("#"+s+"advancedSearchButton").click(),y(t)):(""==t&&y("*"),$("#"+s+"searchtxt").val(t))}},renderUI:f,setOrgchartPath:function(t){n=t},focus:v,getPrefixID:function(){return s},getSearchInput:function(){return $("#"+s+"searchtxt").val()},getResultContainerID:function(){return s+"_result"},getLastSearch:m,generateQuery:k,getLeafFormQuery:function(){return l},renderPreviousAdvancedSearch:g,setSearchFunc:function(t){e=t},search:y,showBusy:w,showNotBusy:b,setRootURL:function(t){p=t}}},workflowModule=new Object,LeafWorkflow=function(a,s){a=a,s=s,Math.floor(1e3*Math.random());var i,d=0,l=0;function c(t){return bgColor=parseInt(t.substring(1),16),r=(16711680&bgColor)>>16,g=(65280&bgColor)>>8,b=255&bgColor,factor=-.1,r+=Math.round(r*factor),g+=Math.round(g*factor),b+=Math.round(b*factor),"#"+((r<<16)+(g<<8)+b).toString(16)}function p(n){if(1==l)return 1;l=1,$("#workflowbox_dep"+n.dependencyID).html('<div style="border: 2px solid black; text-align: center; font-size: 24px; font-weight: bold; background: white; padding: 16px; width: 95%">Applying action... <img src="images/largespinner.gif" alt="loading..." /></div>'),$.ajax({type:"POST",url:"api/?a=formWorkflow/"+d+"/apply",data:n,success:function(t){if(0==t.errors.length)$("#workflowbox_dep"+n.dependencyID).html('<div style="border: 2px solid black; text-align: center; font-size: 24px; font-weight: bold; background: white; padding: 16px; width: 95%">Action applied!</div>'),$("#workflowbox_dep"+n.dependencyID).hide("blind",500),f(d),null!=i&&i();else{var e="";for(var o in t.errors)e+=t.errors[o]+"<br />";$("#workflowbox_dep"+n.dependencyID).html('<div style="border: 2px solid black; text-align: center; font-size: 24px; font-weight: bold; background: white; padding: 16px; width: 95%"><img src="../libs/dynicons/?img=dialog-error.svg&w=48" style="vertical-align: middle" alt="error icon" /> '+e+'<br /><span style="font-size: 14px; font-weight: normal">After resolving the errors, <button id="workflowbtn_tryagain" class="buttonNorm">click here to try again</button>.</span></div>'),$("#workflowbtn_tryagain").on("click",function(){f(d)})}l=0},error:function(t){$("#workflowbox_dep"+n.dependencyID).html('<div style="border: 2px solid black; text-align: center; font-size: 24px; font-weight: bold; background: white; padding: 16px; width: 95%">Error: Workflow Events may not have triggered</div>')}})}function u(t){var e=null==t.description?"Your workflow is missing a requirement. Please check your workflow.":t.description;for(var o in $("#"+a).append('<div id="workflowbox_dep'+t.dependencyID+'" class="workflowbox">                <span>                <div id="stepDescription_dep'+t.dependencyID+'" style="background-color: '+c(t.stepBgColor)+'; padding: 8px">'+e+'</div>                </span>                <form id="form_dep'+t.dependencyID+'" enctype="multipart/form-data" action="#">                    <div id="form_dep_extension'+t.dependencyID+'"></div>                </form>                </div>'),$("#workflowbox_dep"+t.dependencyID).css({padding:"0px","background-color":t.stepBgColor,border:t.stepBorder}),$("#workflowbox_dep"+t.dependencyID+" span").css({"font-size":"120%","font-weight":"bold",color:t.stepFontColor}),$("#form_dep"+t.dependencyID).append('<div id="form_dep_container'+t.dependencyID+'">                <span class="noprint" aria-label="comments">Comments:</span><br />                <textarea id="comment_dep'+t.dependencyID+'" aria-label="comment text area"></textarea>                </div>'),$("#form_dep_container"+t.dependencyID).css({margin:"auto",width:"95%",padding:"8px"}),$("#workflowbox_dep"+t.dependencyID).append('<br style="clear: both"/>'),$("#comment_dep"+t.dependencyID).css({height:"40px",width:"100%",padding:"4px",resize:"vertical"}),t.dependencyActions){var n="";""!=t.dependencyActions[o].actionIcon&&(n='<img src="../libs/dynicons/?img='+t.dependencyActions[o].actionIcon+'&amp;w=22" alt="'+t.dependencyActions[o].actionText+'" style="vertical-align: middle" />'),$("#form_dep_container"+t.dependencyID).append('<div id="button_container'+t.dependencyID+"_"+t.dependencyActions[o].actionType+'" style="float: '+t.dependencyActions[o].actionAlignment+'">\t\t            <button type="button" id="button_step'+t.dependencyID+"_"+t.dependencyActions[o].actionType+'" class="button">\t\t            '+n+" "+t.dependencyActions[o].actionText+"\t\t            </button>\t\t            </div>"),$("#button_step"+t.dependencyID+"_"+t.dependencyActions[o].actionType).css({border:"1px solid black",padding:"6px",margin:"4px"}),$("#button_step"+t.dependencyID+"_"+t.dependencyActions[o].actionType).on("click",{step:t,idx:o},function(t){var e=new Object;e.comment=$("#comment_dep"+t.data.step.dependencyID).val(),e.actionType=t.data.step.dependencyActions[t.data.idx].actionType,e.dependencyID=t.data.step.dependencyID,e.CSRFToken=s,0<t.data.step.dependencyActions[t.data.idx].fillDependency&&void 0!==workflowModule[t.data.step.dependencyID]?workflowModule[t.data.step.dependencyID].trigger(function(){p(e)}):p(e)})}for(var i in t.jsSrcList)$.ajax({type:"GET",url:t.jsSrcList[i],dataType:"script",success:function(){workflowModule[t.dependencyID].init(d)}})}function h(e){$("#"+a).append('<div id="workflowbox_dep'+e.dependencyID+'" class="workflowbox"></div>'),$("#workflowbox_dep"+e.dependencyID).css({"background-color":e.stepBgColor,border:e.stepBorder,"text-align":"center",padding:"8px"}),-1==e.dependencyID?$.ajax({type:"GET",url:"api/?a=form/customData/_"+recordID+"/_"+e.indicatorID_for_assigned_empUID,success:function(t){$("#workflowbox_dep"+e.dependencyID).append("<span>Pending action from "+t[recordID].s1["id"+e.indicatorID_for_assigned_empUID]+"</span>"),$("#workflowbox_dep"+e.dependencyID+" span").css({"font-size":"150%","font-weight":"bold",color:e.stepFontColor})}}):-3==e.dependencyID?$.ajax({type:"GET",url:"api/?a=form/customData/_"+recordID+"/_"+e.indicatorID_for_assigned_groupID,success:function(t){$("#workflowbox_dep"+e.dependencyID).append("<span>Pending action from "+e.description+"</span>"),$("#workflowbox_dep"+e.dependencyID+" span").css({"font-size":"150%","font-weight":"bold",color:e.stepFontColor})}}):($("#workflowbox_dep"+e.dependencyID).append("<span>Pending "+e.description+"</span>"),$("#workflowbox_dep"+e.dependencyID+" span").css({"font-size":"150%","font-weight":"bold",color:e.stepFontColor}))}function f(n){$("#"+a).empty(),$("#"+a).css("display","none"),l=0,d=n,$.ajax({type:"GET",url:"api/?a=formWorkflow/"+n+"/currentStep",dataType:"json",success:function(t){for(var e in t)1==t[e].hasAccess?u(t[e]):h(t[e]);var o,i;o=n,i=t,$.ajax({type:"GET",url:"api/?a=formWorkflow/"+o+"/lastAction",dataType:"json",success:function(t){if(null==t)return null==i&&$("#"+a).append("No actions available"),null;t.stepBgColor=null==t.stepBgColor?"#e0e0e0":t.stepBgColor,t.stepFontColor=null==t.stepFontColor?"#000000":t.stepFontColor,t.stepBorder=null==t.stepBorder?"1px solid black":t.stepBorder;var e=5==t.dependencyID?t.categoryName:t.description;if(null!=i){5!=t.dependencyID&&($("#"+a).append('<div id="workflowbox_lastAction" class="workflowbox" style="padding: 0px; margin-top: 8px"></div>'),$("#workflowbox_lastAction").css({"background-color":t.stepBgColor,border:t.stepBorder}));var o=new Date(1e3*t.time),n="";null!=t.description&&null!=t.actionText?(n='<div style="background-color: '+c(t.stepBgColor)+'; padding: 4px"><span style="float: left; font-size: 90%">'+e+": "+t.actionTextPasttense+"</span>",n+='<span style="float: right; font-size: 90%">'+o.toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})+"</span><br /></div>",""!=t.comment&&null!=t.comment&&(n+='<div style="font-size: 80%; padding: 4px 8px 4px 8px">Comment:<br /><div style="font-weight: normal; padding-left: 16px; font-size: 12px">'+t.comment+"</div></div>")):n="[ Please refer to this request's history for current status ]",5!=t.dependencyID&&$("#workflowbox_lastAction").append('<span style="font-weight: bold; color: '+t.stepFontColor+'">'+n+"</span>")}else $("#workflowcontent").append('<div id="workflowbox_lastAction"></div>'),$("#workflowbox_lastAction").css({"background-color":t.stepBgColor,border:t.stepBorder,"text-align":"center",padding:"0px"}),$("#workflowbox_lastAction").addClass("workflowbox"),o=new Date(1e3*t.time),n="",null!=t.description&&null!=t.actionText?(n='<div style="padding: 4px; background-color: '+c(t.stepBgColor)+'">'+e+": "+t.actionTextPasttense,n+='<br /><span style="font-size: 60%">'+o.toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})+"</span></div>",""!=t.comment&&null!=t.comment&&(n+='<div style="padding: 4px 16px"><fieldset style="border: 1px solid black"><legend class="noprint">Comment</legend><span style="font-size: 80%; font-weight: normal">'+t.comment+"</span></fieldset></div>")):n="[ Please refer to this request's history for current status. ]",$("#workflowbox_lastAction").append('<span style="font-size: 150%; font-weight: bold", color: '+t.stepFontColor+">"+n+"</span>")},cache:!1}),$("#"+a).show("blind",250)},cache:!1})}return{getWorkflow:f,setActionSuccessCallback:function(t){i=t}}},LZString=function(){function o(t,e){if(!a[t]){a[t]={};for(var o=0;o<t.length;o++)a[t][t.charAt(o)]=o}return a[t][e]}var y=String.fromCharCode,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",a={},r={compressToBase64:function(t){if(null==t)return"";var e=r._compress(t,6,function(t){return n.charAt(t)});switch(e.length%4){default:case 0:return e;case 1:return e+"===";case 2:return e+"==";case 3:return e+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:r._decompress(e.length,32,function(t){return o(n,e.charAt(t))})},compressToUTF16:function(t){return null==t?"":r._compress(t,15,function(t){return y(t+32)})+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:r._decompress(e.length,16384,function(t){return e.charCodeAt(t)-32})},compressToUint8Array:function(t){for(var e=r.compress(t),o=new Uint8Array(2*e.length),n=0,i=e.length;n<i;n++){var a=e.charCodeAt(n);o[2*n]=a>>>8,o[2*n+1]=a%256}return o},decompressFromUint8Array:function(t){if(null==t)return r.decompress(t);for(var e=new Array(t.length/2),o=0,n=e.length;o<n;o++)e[o]=256*t[2*o]+t[2*o+1];var i=[];return e.forEach(function(t){i.push(y(t))}),r.decompress(i.join(""))},compressToEncodedURIComponent:function(t){return null==t?"":r._compress(t,6,function(t){return i.charAt(t)})},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),r._decompress(e.length,32,function(t){return o(i,e.charAt(t))}))},compress:function(t){return r._compress(t,16,function(t){return y(t)})},_compress:function(t,e,o){if(null==t)return"";var n,i,a,r={},s={},d="",l="",c="",p=2,u=3,h=2,f=[],g=0,m=0;for(a=0;a<t.length;a+=1)if(d=t.charAt(a),Object.prototype.hasOwnProperty.call(r,d)||(r[d]=u++,s[d]=!0),l=c+d,Object.prototype.hasOwnProperty.call(r,l))c=l;else{if(Object.prototype.hasOwnProperty.call(s,c)){if(c.charCodeAt(0)<256){for(n=0;n<h;n++)g<<=1,m==e-1?(m=0,f.push(o(g)),g=0):m++;for(i=c.charCodeAt(0),n=0;n<8;n++)g=g<<1|1&i,m==e-1?(m=0,f.push(o(g)),g=0):m++,i>>=1}else{for(i=1,n=0;n<h;n++)g=g<<1|i,m==e-1?(m=0,f.push(o(g)),g=0):m++,i=0;for(i=c.charCodeAt(0),n=0;n<16;n++)g=g<<1|1&i,m==e-1?(m=0,f.push(o(g)),g=0):m++,i>>=1}0==--p&&(p=Math.pow(2,h),h++),delete s[c]}else for(i=r[c],n=0;n<h;n++)g=g<<1|1&i,m==e-1?(m=0,f.push(o(g)),g=0):m++,i>>=1;0==--p&&(p=Math.pow(2,h),h++),r[l]=u++,c=String(d)}if(""!==c){if(Object.prototype.hasOwnProperty.call(s,c)){if(c.charCodeAt(0)<256){for(n=0;n<h;n++)g<<=1,m==e-1?(m=0,f.push(o(g)),g=0):m++;for(i=c.charCodeAt(0),n=0;n<8;n++)g=g<<1|1&i,m==e-1?(m=0,f.push(o(g)),g=0):m++,i>>=1}else{for(i=1,n=0;n<h;n++)g=g<<1|i,m==e-1?(m=0,f.push(o(g)),g=0):m++,i=0;for(i=c.charCodeAt(0),n=0;n<16;n++)g=g<<1|1&i,m==e-1?(m=0,f.push(o(g)),g=0):m++,i>>=1}0==--p&&(p=Math.pow(2,h),h++),delete s[c]}else for(i=r[c],n=0;n<h;n++)g=g<<1|1&i,m==e-1?(m=0,f.push(o(g)),g=0):m++,i>>=1;0==--p&&(p=Math.pow(2,h),h++)}for(i=2,n=0;n<h;n++)g=g<<1|1&i,m==e-1?(m=0,f.push(o(g)),g=0):m++,i>>=1;for(;;){if(g<<=1,m==e-1){f.push(o(g));break}m++}return f.join("")},decompress:function(e){return null==e?"":""==e?null:r._decompress(e.length,32768,function(t){return e.charCodeAt(t)})},_decompress:function(t,e,o){var n,i,a,r,s,d,l,c=[],p=4,u=4,h=3,f="",g=[],m={val:o(0),position:e,index:1};for(n=0;n<3;n+=1)c[n]=n;for(a=0,s=Math.pow(2,2),d=1;d!=s;)r=m.val&m.position,m.position>>=1,0==m.position&&(m.position=e,m.val=o(m.index++)),a|=(0<r?1:0)*d,d<<=1;switch(a){case 0:for(a=0,s=Math.pow(2,8),d=1;d!=s;)r=m.val&m.position,m.position>>=1,0==m.position&&(m.position=e,m.val=o(m.index++)),a|=(0<r?1:0)*d,d<<=1;l=y(a);break;case 1:for(a=0,s=Math.pow(2,16),d=1;d!=s;)r=m.val&m.position,m.position>>=1,0==m.position&&(m.position=e,m.val=o(m.index++)),a|=(0<r?1:0)*d,d<<=1;l=y(a);break;case 2:return""}for(i=c[3]=l,g.push(l);;){if(m.index>t)return"";for(a=0,s=Math.pow(2,h),d=1;d!=s;)r=m.val&m.position,m.position>>=1,0==m.position&&(m.position=e,m.val=o(m.index++)),a|=(0<r?1:0)*d,d<<=1;switch(l=a){case 0:for(a=0,s=Math.pow(2,8),d=1;d!=s;)r=m.val&m.position,m.position>>=1,0==m.position&&(m.position=e,m.val=o(m.index++)),a|=(0<r?1:0)*d,d<<=1;c[u++]=y(a),l=u-1,p--;break;case 1:for(a=0,s=Math.pow(2,16),d=1;d!=s;)r=m.val&m.position,m.position>>=1,0==m.position&&(m.position=e,m.val=o(m.index++)),a|=(0<r?1:0)*d,d<<=1;c[u++]=y(a),l=u-1,p--;break;case 2:return g.join("")}if(0==p&&(p=Math.pow(2,h),h++),c[l])f=c[l];else{if(l!==u)return null;f=i+i.charAt(0)}g.push(f),c[u++]=i+f.charAt(0),i=f,0==--p&&(p=Math.pow(2,h),h++)}}};return r}();"function"==typeof define&&define.amd?define(function(){return LZString}):"undefined"!=typeof module&&null!=module&&(module.exports=LZString);var XSSHelpers=(buildTagRegex=function(t){return new RegExp("(<\\/?\\s*\\b"+t+"\\b(.*?)\\s*>)","g")},cleanTag=function(t){return t.replace(/<\s*\/?|>/g,"").trim()},containsTag=function(t,e){return null!==buildTagRegex(cleanTag(e)).exec(t)},containsTags=function(t,e,o){null==o&&(o=!1);for(var n=0;n<e.length;n++){var i=containsTag(t,e[n]);if(o){if(!i)return!1}else if(i)return!0}return!1},stripAllTags=function(t){return t.replace(buildTagRegex(""),"")},stripTag=function(t,e){return t.replace(buildTagRegex(cleanTag(e)),"")},stripTags=function(t,e){for(var o=0;o<e.length;o++)t=stripTag(t,e[o]);return t},{buildTagRegex:buildTagRegex,containsTag:containsTag,containsTags:containsTags,stripAllTags:stripAllTags,stripTag:stripTag,stripTags:stripTags});"undefined"!=typeof module&&(module.exports=XSSHelpers);