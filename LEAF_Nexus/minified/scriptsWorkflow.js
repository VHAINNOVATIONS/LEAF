function groupSelector(t){this.basePath="",this.apiPath="./api/?a=",this.selection="",this.containerID=t,this.prefixID="grpSel"+Math.floor(1e3*Math.random())+"_",this.timer=0,this.q="",this.isBusy=1,this.backgroundImage="images/indicator.gif",this.intervalID=null,this.tag="",this.selectHandler=null,this.resultHandler=null,this.selectLink=null,this.selectionData=new Object,this.inputID="#"+this.prefixID+"input",this.optionNoLimit=0,this.currRequest=null,this.jsonResponse=null,this.numResults=0}groupSelector.prototype.initialize=function(){var e=this;$("#"+this.containerID).html('<div id="'+this.prefixID+'border" class="groupSelectorBorder">\t\t\t<div style="float: left"><img id="'+this.prefixID+'icon" src="'+this.basePath+'../libs/dynicons/?img=search.svg&w=16" class="groupSelectorIcon" alt="search" />\t\t\t<img id="'+this.prefixID+'iconBusy" src="'+this.basePath+'images/indicator.gif" style="display: none" class="groupSelectorIcon" alt="search" /></div>\t\t\t<input id="'+this.prefixID+'input" type="search" class="groupSelectorInput" aria-label="search"></input></div>\t\t\t<div id="'+this.prefixID+'result"></div>'),$(this.inputID).on("keydown",function(t){e.showBusy(),e.timer=0,""==$(e.inputID).val()&&(e.q=""),13==t.keyCode&&(e.q="",e.search())}),this.showNotBusy(),this.intervalID=setInterval(function(){e.search()},200)},groupSelector.prototype.showNotBusy=function(){1==this.isBusy&&($("#"+this.prefixID+"icon").css("display","inline"),$("#"+this.prefixID+"iconBusy").css("display","none"),this.isBusy=0)},groupSelector.prototype.showBusy=function(){$("#"+this.prefixID+"icon").css("display","none"),$("#"+this.prefixID+"iconBusy").css("display","inline"),this.isBusy=1},groupSelector.prototype.select=function(t){for(var e in this.selection=t,nodes=$("#"+this.containerID+" .groupSelected"),nodes)null!=nodes[e].id&&($("#"+nodes[e].id).removeClass("groupSelected"),$("#"+nodes[e].id).addClass("groupSelector"));$("#"+this.prefixID+"grp"+t).addClass("groupSelected"),$("#"+this.prefixID+"grp"+t).removeClass("groupSelector"),null!=this.selectHandler&&this.selectHandler()},groupSelector.prototype.searchTag=function(t){this.tag=t},groupSelector.prototype.setSelectHandler=function(t){this.selectHandler=t},groupSelector.prototype.setResultHandler=function(t){this.resultHandler=t},groupSelector.prototype.setSelectLink=function(t){this.selectLink=t},groupSelector.prototype.clearSearch=function(){$("#"+this.prefixID+"input").val("")},groupSelector.prototype.forceSearch=function(t){$("#"+this.prefixID+"input").val(t.replace(/<[^>]*>/g,""))},groupSelector.prototype.hideInput=function(){$("#"+this.prefixID+"border").css("display","none")},groupSelector.prototype.hideResults=function(){$("#"+this.prefixID+"result").css("display","none")},groupSelector.prototype.showResults=function(){$("#"+this.prefixID+"result").css("display","inline")},groupSelector.prototype.enableNoLimit=function(){this.optionNoLimit=1},groupSelector.prototype.configInputID=function(t){this.inputID=t},groupSelector.prototype.search=function(){if(null==$("#"+this.prefixID+"input").val()||null==$("#"+this.prefixID+"input"))return clearInterval(this.intervalID),!1;if(this.timer+=5e3<this.timer?0:200,300<this.timer){var t=0,i=$("#"+this.prefixID+"input").val().replace(/<[^>]*>/g,"");if(null==i)return clearInterval(this.intervalID),!1;if(0!=this.q.length&&this.q.length<i.length&&0==this.numResults&&(t=1),""!=i&&i!=this.q&&0==t){this.q=i,null!=this.currRequest&&this.currRequest.abort();var s=this;this.currRequest=$.ajax({url:this.apiPath+"group/search",dataType:"json",data:{q:this.q,tag:this.tag,noLimit:this.optionNoLimit},success:function(t){s.currRequest=null,s.selection="",s.numResults=0,s.jsonResponse=t,$("#"+s.prefixID+"result").html("");var e='<table class="groupSelectorTable"><tr><th>Group Title</th></tr><tbody id="'+s.prefixID+'result_table"></tbody></table>';$("#"+s.prefixID+"result").html(e+$("#"+s.prefixID+"result").html()),0==t.length&&$("#"+s.prefixID+"result_table").append('<tr id="'+s.prefixID+'emp0"><td style="font-size: 120%; background-color: white; text-align: center">No results for &quot;<span style="color: red">'+i+"</span>&quot;</td></tr>"),s.selectionData=new Object,$.each(t,function(t,e){s.selectionData[e.groupID]=e,linkText=e.groupTitle,null!=s.selectLink&&(linkText='<a href="'+s.selectLink+"&groupID="+e.groupID+'">'+linkText+"</a>"),$("#"+s.prefixID+"result_table").append('<tr id="'+s.prefixID+"grp"+e.groupID+'"><td class="groupSelectorTitle" title="'+e.groupID+'">'+linkText+"</td></tr>"),$("#"+s.prefixID+"grp"+e.groupID).addClass("groupSelector"),$("#"+s.prefixID+"grp"+e.groupID).on("click",function(){s.select(e.groupID)}),s.numResults++}),1==s.numResults&&(s.selection=t[0].groupID),null!=s.resultHandler&&s.resultHandler(),s.showNotBusy()},cache:!1})}else""==i&&(this.q=i,$("#"+this.prefixID+"result").html(""),this.numResults=0,this.selection="",null!=this.resultHandler&&this.resultHandler()),this.showNotBusy()}};var XSSHelpers=(buildTagRegex=function(t){return new RegExp("(<\\/?\\s*\\b"+t+"\\b(.*?)\\s*>)","g")},cleanTag=function(t){return t.replace(/<\s*\/?|>/g,"").trim()},containsTag=function(t,e){return null!==buildTagRegex(cleanTag(e)).exec(t)},containsTags=function(t,e,i){null==i&&(i=!1);for(var s=0;s<e.length;s++){var r=containsTag(t,e[s]);if(i){if(!r)return!1}else if(r)return!0}return!1},stripAllTags=function(t){return t.replace(buildTagRegex(""),"")},stripTag=function(t,e){return t.replace(buildTagRegex(cleanTag(e)),"")},stripTags=function(t,e){for(var i=0;i<e.length;i++)t=stripTag(t,e[i]);return t},{buildTagRegex:buildTagRegex,containsTag:containsTag,containsTags:containsTags,stripAllTags:stripAllTags,stripTag:stripTag,stripTags:stripTags});"undefined"!=typeof module&&(module.exports=XSSHelpers);